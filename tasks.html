<!doctype html>
<!-- Conditional comment for mobile ie7 blogs.msdn.com/b/iemobile/ -->
<!--[if IEMobile 7 ]>    <html class="no-js iem7" lang="en"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
  <meta charset="utf-8">

  <title> Bolt jQuery Mobile Website</title>
  <meta name="description" content="">

  <!-- Mobile viewport optimization h5bp.com/ad -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">

  <!-- Home screen icon  Mathias Bynens mathiasbynens.be/notes/touch-icons -->
  <!-- For iPhone 4 with high-resolution Retina display: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/h/apple-touch-icon.png">
  <!-- For first-generation iPad: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/m/apple-touch-icon.png">
  <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="img/l/apple-touch-icon-precomposed.png">
  <!-- For nokia devices: -->
  <link rel="shortcut icon" href="img/l/apple-touch-icon.png">
  <link href="css/mobiscroll.custom-2.4.3.min.css" rel="stylesheet" type="text/css" />  
  


  <!-- iOS web app, delete if not needed. https://github.com/h5bp/mobile-boilerplate/issues/94 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black"> 
  <!-- <script>(function(){var a;if(navigator.platform==="iPad"){a=window.orientation!==90||window.orientation===-90?"img/startup-tablet-landscape.png":"img/startup-tablet-portrait.png"}else{a=window.devicePixelRatio===2?"img/startup-retina.png":"img/startup.png"}document.write('<link rel="apple-touch-startup-image" href="'+a+'"/>')})()</script> -->
  
  <!-- The script prevents links from opening in mobile safari. https://gist.github.com/1042026 -->
  <!-- <script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d=d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standalone")</script> -->
  
  <!-- Mobile IE allows us to activate ClearType technology for smoothing fonts for easy reading -->
  <!--<meta http-equiv="cleartype" content="on">-->

  <!-- more tags for your 'head' to consider h5bp.com/d/head-Tips -->
  
  
  <!-- fonts -->
  <!--<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600' rel='stylesheet' type='text/css'>-->

  
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/flexslider.css">
    
  <link rel="stylesheet" href="css/photoswipe/photoswipe.css">
  <link rel="stylesheet" href="css/jquery.mobile-1.1.1.css">
  
  <!--<link rel="stylesheet" href="css/jquery-ui-1.8.16.custom.css">-->
  
  
  <link rel="stylesheet" href="css/themes/theme-black.css">
  
  
  
  
  <!-- Main Stylesheet -->
  <!--<link rel="stylesheet" href="css/style.css">-->
  
  <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects -->
  <script src="js/libs/modernizr-2.0.6.min.js"></script>
  <script src="cordova-2.5.0rc1.js"></script>
  <style type="text/css">
  .value{
    font-size: 24px;
    padding:10px;
  }
  input[type="text"]{
    font-size:18px;
    padding: 5px;
  }
  .goto{
    margin: 5px 5px 0px 10px;
    border: 1px solid rgba(125,125,125,0.1);
  }
  </style>
</head>
<body>
<div id="splash" class="splash"> 
  <img id="splashBg" src="img/splash.jpg" alt="Splash Image">
  <img id="splashTitle" src="img/splashTitle.png" alt="Splash Title">
</div>




  <div id="container" data-role="page" >
            
    <header>
    
      <div class="upperMenu">
        <div class="pagesMenu flexslider">
          <ul class="slides">
              <li>
                  <a href="crew.html" id="linkCrew" class="pageLink pageLink-1-1">
                    <div class="iconBox">
                      <img src="img/home/crew_icon.png" alt="crew">
                    </div>
                    <div class="titleBox">
                      Crew
                    </div>
                  </a>
              </li>
              <li>            
                  <a href="timesheet.html" id="linkTimesheet" class="pageLink pageLink-1-1 ">
                    <div class="iconBox">
                      <img src="img/home/timesheet_icon.png" alt="timesheet">
                    </div>
                    <div class="titleBox">
                      Timesheet
                    </div>
                  </a>
              </li>
          </ul>
      </div>
      </div>

      <div id="header">
        <a href="index.html" class="homeButton" data-direction="reverse"></a>
        <a href="#" class="menuButton"></a>
        
        <h1>Tasks</h1>
        <h2></h2>
        
        <!--<a href="portfolio.html" class="nextButton">&raquo;</a>-->
        
        <!--
        <a href="index.html">
          <div class="iButtonBody">
            <div>
              <span></span>
            </div>
            <p>Back</p>
          </div>
        </a>
        -->
      </div>
    </header>
    <!--
    <div id="main" role="main">
    </div>
    -->
    
    <div id="pageServices" class="page">
        <select id="Project" name="Projects" data-role="none" style="display:none;">
                    <!-- projects will be all here -->
            </select>
            
        <div class="content">
            <!--<h5 class="sectionTitle"> Personal </h5>-->
            <div id="pivotTabs" class="pivotTabs">
              <div id="scroller">
                <ul id="thelist">
                  <!--
                  <li> <a href="#" data-value="#qualificationsTab"> electronics</a> </li>
                  <li> <a href="#" data-value="#furnitureTab"> furniture</a> </li>
                  <li> <a href="#" data-value="#householdTab"> household</a> </li>
                  <li> <a href="#" data-value="#machineryTab"> machinery</a> </li>
                  <li> <a href="#" class="goToFirst">&laquo;</a> </li>
                  -->
                </ul>
              </div>
            </div>
        </div>   
        <div class="content" id="allTasks">     
        
        </div>
        <!-- end  content -->   
    </div>
    <div class="clearfix"></div>
  </div> <!--! end of #container -->


  <!-- JavaScript at the bottom for fast page loading -->

  <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
  <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>-->
  <!--<script>window.jQuery || document.write('<script src="js/libs/jquery-1.7.1.min.js"><\/script>')</script>-->
  <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>-->
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.8.2.min.js"><\/script>')</script>

  
  <!--validation for older browsers (if) -->
  
  
  <script src="js/iscroll.js"></script>
  <script src="js/jquery.flexslider-min.js"></script>
  <script src="js/photoswipe/klass.min.js"></script>
  <script src="js/photoswipe/code.photoswipe.jquery-3.0.5.min.js"></script>
  <script src="js/mobiscroll.custom-2.4.3.min.js" type="text/javascript"></script>
  <script>
    $(document).bind("mobileinit", function(){
      
          $.mobile.defaultPageTransition = 'none';
          //$.mobile.defaultPageTransition = 'slide';
          //$.mobile.defaultPageTransition = 'fade';
          //$.mobile.defaultPageTransition = 'flow';
          //$.mobile.defaultPageTransition = 'flip';
          //$.mobile.defaultPageTransition = 'pop';
          
          $.mobile.ignoreContentEnabled = true;
          
          //enable this if you want your website to run without jQuery Mobile Navigation
          $.mobile.ajaxEnabled = false;
          var user =JSON.parse(localStorage.user);
          function loadTasks(AccountProjectId,itemToLoad){
            $itemToLoad=$(itemToLoad);
            xmlhttp= new XMLHttpRequest();
            xmlhttp.open("POST","http://krooe.com/php/getprojecttasks.php",true);
            xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            xmlhttp.send("AccountProjectId="+AccountProjectId);
            xmlhttp.onload=function(){
                res=xmlhttp.responseText;
                res=JSON.parse(res);
                console.log(res);
                localStorage.setItem("tasks",JSON.stringify(res));
                var taskGroup='<div id="project_id_'+AccountProjectId+'" class="pivotTab" >';
                    taskGroup+='<div class="groupBox">';
                    taskGroup+='<ul>';
                    if(res.length>0){
                      $.each(res,function(i,obj){
                      taskGroup+='<li style="overflow:hidden;">'+
                                    '<p class="value" data-task-id="'+obj.AccountProjectTaskId+'">'+obj.TaskName+'</p>'+
                                    '<div><a href="#"style="float:left;"><img src="img/home/timesheet_icon.png" class="goto" data-task-id="'+obj.AccountProjectTaskId+'" style="width:40px;height:40px;" alt="timesheet" data-task-name="'+obj.TaskName+'" /></a><p class="desc" style="margin-left:10px;float:right;">'+obj.TaskDescription+'</p></div>'+
                                                                       
                                  '</li>';
                          //$itemToLoad.append('<li id="'+obj.AccountProjectTaskId+'">'+obj.TaskName+'</li>');   
                      });     
                    }else{
                      taskGroup+='<li>'+
                                    '<p class="value">There is no Tasks in this project. </p>'+
                                  '</li>';
                    }
                    taskGroup+='</ul>'; 
                    taskGroup+='</div><!-- end group box -->'; 
                    taskGroup+='</div><!-- end tab -->';
                    $(itemToLoad).html(taskGroup);
                    $("#project_id_"+AccountProjectId).show();    
                    $(".desc").width($(".value").outerWidth(true)-68);           
                };
            }   
          function loadProjects(itemToLoad){
            $itemToLoad=$(itemToLoad);
            var AccountId;
            /*var user =localStorage.getItem("user");
            user= JSON.parse(user);*/
            AccountId=user.AccountId;
            xmlhttp= new XMLHttpRequest();
            xmlhttp.open("POST","http://krooe.com/php/getproject.php",true);
            xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            xmlhttp.send("AccountId="+AccountId);
            xmlhttp.onload=function(){
                data=xmlhttp.responseText;
                data=JSON.parse(data);
                localStorage.setItem("projects",JSON.stringify(data));
                var json= JSON.parse(localStorage.projects);
                console.log($itemToLoad);
                $itemToLoad.html("");
                $.each(json,function(i,obj){ 
                ///console.log(obj); 
                    //$itemToLoad.append('<option value="'+obj.AccountProjectId+'">'+obj.ProjectName+'</option>');
                    $("#Project").append('<option value="#project_id_'+obj.AccountProjectId+'">'+obj.ProjectName+'</option>');
                    $itemToLoad.append('<li> <a href="#" data-value="#project_id_'+obj.AccountProjectId+'">'+obj.ProjectName+'</a> </li>');
                    //load all the tasks here 
                    
                });
                $itemToLoad.append('<li> <a href="#" class="goToFirst">&laquo;</a> </li>');
              }
            }
            loadProjects("#thelist");
            localStorage.current_tab="";
            //selecting the project id from the list ...
            $("#thelist li a").live("click",function(){
              $tab=$($(this).attr('data-value'));
              if(localStorage.current_tab!=$(this).attr('data-value')){
                localStorage.current_tab=$(this).attr('data-value')
                var projectId=$(this).attr('data-value');
                projectId=projectId.substr(12);
                
                var selected_project={
                   'project_id':projectId,
                   'project_name':$(this).html()
                };
                localStorage.selected_project=JSON.stringify(selected_project);
                loadTasks(projectId,"#allTasks");              
              }
            });
            $('#Project').mobiscroll().select({
            theme: 'android-ics light',
            display: 'bottom',
            mode: 'scroller',
            inputClass: 'i-txt',
            width: 320,
            onSelect: function(valueText, inst) {
              $("#thelist li a[data-value='"+$(this).val()+"']").trigger("click");
             
              //the id 
              var projectId=$(this).val();
                  projectId=projectId.substr(12);
              // the text value 
              var selected_project={
                   'project_id':projectId,
                   'project_name':inst.settings.wheels[0].Projects['_'+$(this).val()]
                };
                localStorage.selected_project=JSON.stringify(selected_project);
              /*var selected_project={
                   'project_id':projectId,
                   'project_name':$(this).html()
                };
                localStorage.selected_project=JSON.stringify(selected_project);*/
            }
        }); 
            $("#Project_dummy").val("");
            $("#Project_dummy").attr("placeholder","Tap here to Select a Project ...");
            $(".value").click(function(){
              localStorage.selectedTask=$(this).attr("data-task-id");
              $.mobile.changePage("crew.html");
            });
            $(".goto").live("click",function(){
              localStorage.from_task='true';
              var selected_task={
                  'task_id':$(this).attr("data-task-id"),
                  'task_name':$(this).attr("data-task-name")
              };
              localStorage.selected_task=JSON.stringify(selected_task);
              window.location.href="timesheet.html";
            });

    });
  </script>
  <!--<script src="js/jquery.mobile-1.1.1.min.js"></script>-->
  <script src="js/jquery.mobile-1.2.0.min.js"></script>
  <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
  

  <!--
  <script src="js/hammer/hammer.js"></script>
  <script src="js/hammer/jquery.hammer.js"></script>
  -->
  
  <script src="js/helper.js"></script>
  <script src="js/script.js"></script>
  
  <!-- end scripts-->

  <!-- Debugger - remove for production -->
  <!-- <script src="https://getfirebug.com/firebug-lite.js"></script> -->

  <!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
       mathiasbynens.be/notes/async-analytics-snippet -->
  
</body>
</html>